services:
  redis: { image: "redis:7-alpine" }
  clamav: { image: "clamav/clamav:stable", restart: always }
  api:
    build: ./services/api
    env_file: .env
  worker:
    build: ./services/worker
    env_file: .env
    depends_on: [redis, clamav]
  ingest:
    build: ./services/ingest
    env_file: .env
    volumes: ["./data:/data"]
    depends_on: [api]
